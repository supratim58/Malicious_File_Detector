rule Suspicious_PowerShell {
    meta:
        description = "Detects suspicious PowerShell commands"
        author = "Mr.Panda"
        date = "2023-10-01"

    strings:
        $ps1 = "powershell.exe" nocase
        $cmd1 = "Invoke-Expression" nocase
        $cmd2 = "DownloadString" nocase

    condition:
        any of them
}

rule Base64_Encoded_Payload {
    meta:
        description = "Detects Base64 encoded payloads"
        author = "Mr.Panda"
        date = "2023-10-01"

    strings:
        $base64 = /[A-Za-z0-9+\/]{20,}={0,2}/  // Regex for Base64 strings

    condition:
        $base64
}

rule Common_Malware_Strings {
    meta:
        description = "Detects common malware strings"
        author = "Mr.Panda"
        date = "2023-10-01"

    strings:
        $str1 = "cmd.exe" nocase
        $str2 = "regsvr32" nocase
        $str3 = "ShellExecute" nocase

    condition:
        any of them
}

rule Obfuscated_JavaScript {
    meta:
        description = "Detects obfuscated JavaScript"
        author = "Mr.Panda"
        date = "2023-10-01"

    strings:
        $js1 = "eval(" nocase
        $js2 = "unescape(" nocase
        $js3 = "fromCharCode(" nocase

    condition:
        any of them
}

rule Executable_Signature {
    meta:
        description = "Detects executable file signatures"
        author = "Mr.Panda"
        date = "2023-10-01"

    strings:
        $mz = { 4D 5A }  // "MZ" signature for Windows executables

    condition:
        $mz
}