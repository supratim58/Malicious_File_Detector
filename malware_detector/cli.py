import argparse
from malware_detector.core import analyze_file
import yara

def main():
    parser = argparse.ArgumentParser(description="Malware Detection Tool")
    parser.add_argument("file_path", help="path to the file to analyze")
    args = parser.parse_args()

    yara_rules = yara.compile(filepath='malware_rules.yar')

    report = analyze_file(args.file_path, yara_rules)
    print(report)

if __name__ == "__main__":
    main()